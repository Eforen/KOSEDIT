<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="../lib/google-blockly/blockly_compressed.js"></script>
    <script src="../lib/google-blockly/blocks_compressed.js"></script>

    <!-- My modifications to the Blockly Lib -->
    <script src="../js/customized_field_dropdown.js"></script>

    <link rel="stylesheet" type="text/css" href="../css/common.css">
    <link rel="stylesheet" type="text/css" href="../css/style.css">
    <script type="text/javascript" src="../js/common.js"></script>
    <script type="text/javascript" src="../js/code.js"></script>
    <!--<script type="text/javascript" src="/storage.js"></script>-->
    <link rel="stylesheet" type="text/css" href="../css/prettify.css">
    <script type="text/javascript" src="../lib/prettify/prettify.js"></script>

    <script src="../js/blockly-client-save.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/editor.css">
    <link rel="stylesheet" type="text/css" href="../css/main.css">
  </head>
  <body>

  <!-- Ensure that lang-KerboScript.js is loaded after prettify.js.  -->
  <script type="text/javascript" src="../js/lang-KerboScript.js"></script>

  <script type="text/javascript" src="../lib/google-blockly/msg/js/en.js"></script>

  <!-- API -->
  <script src="../js/kOSall.js"></script>

  <!-- Render the page.  -->
  <table width="100%" height="100%">
    <tr>
      <td>
        <h1>
          <span id="title">
            <a href="http://eforen.tv">Eforen.TV</a> : kOS IDE
          </span>
        </h1>
      </td>
      <td class="farSide">
      </td>
    </tr>
    <tr>
      <td colspan=2>
        <table width="100%">
          <tr id="tabRow" height="1em">
            <td id="tab_blocks" class="tabon" onclick="Code.tabClick(this.id)">Blocks</td>
            <td class="tabmin">&nbsp;</td>
            <td id="tab_kerboscript" class="taboff" onclick="Code.tabClick(this.id)">KerboScript</td>
            <td class="tabmin">&nbsp;</td>
            <td id="tab_xml" class="taboff" onclick="Code.tabClick(this.id)">XML</td>
            <td class="tabmax">
              <button id="trashButton" class="notext" title="Discard all blocks.">
                <img src='../../media/1x1.gif' class="trash icon21">
              </button>&nbsp;
              <button id="linkButton" class="notext" title="Save and link to blocks.">
                <img src='../../media/1x1.gif' class="link icon21">
              </button>&nbsp;
              <button id="pastebinButton" title="Save KerboScript code to Pastebin.">
                PASTEBIN
              </button>&nbsp;

            </td>
          </tr>
          <tr>
            <td width=300></td>
            <td>
              <!-- From apps.dialog.  -->
              <div id="dialogShadow" class="dialogAnimate"></div>
              <div id="dialogBorder"></div>
              <div id="dialog"></div>
            </td>
          </tr>
        </table>
      </td>
    </tr>
    <tr>
      <td height="99%" colspan=2 id="content_area">
    <xml id="toolbox" style="display: none">
    <category name="kOS IDE Settings">
      <block type="kos_lazyglobal"></block>
      <block type="kos_sas-correction"></block>
    </category>
    <category name="kOS Workarounds">
      <block type="workaround_input"></block>
      <block type="workaround_input_flow"></block>
    </category>
    <category name="Language">
      <category name="Directives">
        <block type="kos_lazyglobal"></block>
      </category>
      <category name="comments">
        <block type="comment"></block>
      </category>
      <category name="Screen">
        <block type="kos_clearscreen"></block>
      </category>
    </category>
    <category name="Data Types">
      <category name="Vector">
        <block type="vector_construct"></block>
        <block type="vector_math"></block>
      </category>
    </category>
    <category name="KerboScript">
      <category name="Vessels">
        <block type="vessel_byname"></block>
        <block type="kos_vessels_ship"></block>
        <block type="kos_vessels_target"></block>
        <block type="kos_vessels_ship_control"></block>
        <block type="kos_vessels_target_control"></block>
        <block type="Vessel_properties"><value name="PARENT"><block type="text"></block></value></block>
        <!--<block type="Vessel_properties" inline="false"><mutation second_input="true"></mutation><field name="NAME">PARTSNAMED</field><value name="VESSEL"><block type="kos_vessels_ship"></block></value><value name="ARG"><block type="text"><field name="TEXT">Test</field></block></value></block>-->
      </category>
      <category name="Flight Controls">
        <block type="kos_vessels_ship_control"></block>
        <block type="kos_vessels_target_control"></block>
        <block type="RawControl_properties"><value name="PARENT"><block type="kos_vessels_ship_control"></block></value></block>
        <block type="PilotControl_properties"><value name="PARENT"><block type="kos_vessels_ship_control"></block></value></block>
      </category>
      <category name="Ship Systems">
        <block type="kos_onoff"></block>
        <block type="kos_shipsys_rcs"><value name="STATE"><block type="kos_onoff"></block></value></block>
        <block type="kos_shipsys_sas"><value name="STATE"><block type="kos_onoff"></block></value></block>
        <block type="kos_shipsys_lights"><value name="STATE"><block type="kos_onoff"></block></value></block>
        <block type="kos_shipsys_brakes"><value name="STATE"><block type="kos_onoff"></block></value></block>
        <block type="kos_shipsys_target"><value name="NAME"><block type="text"></block></
        <block type="kos_on"></block>
        <block type="kos_off"></block>
        <block type="kos_shipsys_rcs_key"></block>
        <block type="kos_shipsys_sas_key"></block>
        <block type="kos_shipsys_lights_key"></block>
        <block type="kos_shipsys_brakes_key"></block>value></block>
      </category>
      <category name="Math">
        <block type="Direction_properties"></block>
        <block type="Vector_properties"></block>
        <block type="GeoCoordinates_properties"></block>
      </category>
      <category name="Orbits">
        <block type="Orbit_properties"></block>
        <block type="Orbitable_properties"></block>
        <block type="OrbitableVelocity_properties"></block>
      </category>
      <category name="Celestial Bodies">
        <block type="Atmosphere_properties"></block>
        <block type="Body_properties"></block>
      </category>
      <category name="Vessels & Parts">
        <block type="AggregateResource_properties"></block>
        <block type="DockingPort_properties"></block>
        <block type="Engine_properties"></block>
        <block type="Gimbal_properties"></block>
        <block type="ManeuverNode_properties"></block>
        <block type="Part_properties"></block>
        <block type="PartModule_properties"></block>
        <block type="Resource_properties"></block>
        <block type="Sensor_properties"></block>
        <block type="Vessel_properties"></block>
        <block type="VesselSensors_properties"></block>
      </category>
      <category name="Misc">
        <block type="Waypoint_properties"></block>
        <block type="Iterator_properties"></block>
        <block type="VecDraw_properties"></block>
        <block type="Config_properties"></block>
        <block type="Terminal_properties"></block>
        <block type="TimeSpan_properties"></block>
      </category>
    </category>
    <category name="Flow Control">
      <category name="If">
        <block type="controls_if"></block>
        <block type="controls_if">
          <mutation else="1"></mutation>
        </block>
        <block type="controls_if">
          <mutation elseif="1" else="1"></mutation>
        </block>
      </category>
      <category name="kOS">
        <block type="kos_stage"></block>
        <block type="kos_wait"></block>
        <block type="kos_wait_until"></block>
        <block type="kos_lock"></block>
        <block type="kos_ontrigger"></block>
      </category>
      <category name="Boolean">
        <block type="logic_compare"></block>
        <block type="logic_operation"></block>
        <block type="logic_negate"></block>
        <block type="logic_boolean"></block>
        <block type="logic_null"></block>
        <block type="logic_ternary"></block>
      </category>
    </category>
    <category name="Loops">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <block type="math_number">
            <field name="NUM">10</field>
          </block>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
      <block type="controls_for">
        <field name="VAR">i</field>
        <value name="FROM">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <field name="NUM">10</field>
          </block>
        </value>
        <value name="BY">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
      </block>
      <block type="controls_forEach"></block>
      <block type="controls_flow_statements"></block>
    </category>
    <category name="Math">
      <block type="math_number"></block>
      <block type="math_arithmetic"></block>
      <block type="math_single"></block>
      <block type="math_trig"></block>
      <block type="math_constant"></block>
      <block type="math_number_property"></block>
      <block type="math_change">
        <value name="DELTA">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
      </block>
      <block type="math_round"></block>
      <block type="math_on_list"></block>
      <block type="math_modulo"></block>
      <block type="math_constrain">
        <value name="LOW">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="HIGH">
          <block type="math_number">
            <field name="NUM">100</field>
          </block>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <block type="math_number">
            <field name="NUM">1</field>
          </block>
        </value>
        <value name="TO">
          <block type="math_number">
            <field name="NUM">100</field>
          </block>
        </value>
      </block>
      <block type="math_random_float"></block>
    </category>
    <category name="Text">
      <block type="text"></block>
      <block type="text_print"></block><block type="text_join"></block>
      <block type="text_create_join_container"></block>
      <block type="text_create_join_item"></block>
      <block type="text_append"></block>
      <block type="text_length"></block>
      <block type="text_isEmpty"></block>
      <block type="text_indexOf"></block>
      <block type="text_charAt"></block>
      <block type="text_getSubstring"></block>
      <block type="text_changeCase"></block>
      <block type="text_trim"></block>
      <block type="text_prompt"></block>
      <block type="text_prompt_ext"></block>
      <!---->
    </category>
    <category name="Lists">
      <block type="lists_create_empty"></block>
      <block type="lists_create_with"></block>
      <block type="lists_repeat">
        <value name="NUM">
          <block type="math_number">
            <field name="NUM">5</field>
          </block>
        </value>
      </block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
      <block type="lists_indexOf"></block>
      <block type="lists_getIndex"></block>
      <block type="lists_setIndex"></block>
    </category>
    <category name="Variables">
      <category name="All Variables" custom="VARIABLE"></category>
      <block type="lang_declare"></block>
      <block type="lang_declare_parameter"></block>
      <block type="kos_set"></block>
      <block type="kos_lock"></block>
      <block type="kos_toggle"></block>
    </category>
    <category name="Functions" custom="PROCEDURE"></category>
    <sep></sep>
    <category name="Library">
      <category name="IDE Debuging">
        <block type="variables_set" inline="true"><field name="VAR">item</field><value name="VALUE"><block type="vector_math" inline="true"><field name="OP">ADD</field><value name="var1"><block type="vector_math" inline="true"><field name="OP">ADD</field><value name="var1"><block type="vector_construct" inline="true"><value name="X"><block type="math_number"><field name="NUM">1</field></block></value><value name="Y"><block type="math_number"><field name="NUM">2</field></block></value><value name="Z"><block type="math_number"><field name="NUM">3</field></block></value></block></value><value name="var2"><block type="math_number"><field name="NUM">4</field></block></value></block></value><value name="var2"><block type="vector_construct" inline="true"><value name="X"><block type="math_number"><field name="NUM">5</field></block></value><value name="Y"><block type="math_number"><field name="NUM">6</field></block></value><value name="Z"><block type="math_number"><field name="NUM">7</field></block></value></block></value></block></value><next><block type="text_print" inline="false"><value name="TEXT"><block type="variables_get"><field name="VAR">item</field></block></value></block></next></block>

      </category>
      <category name="Examples">
        <block type="comment"><field name="TEXT">****************************</field><next><block type="comment"><field name="TEXT">****************************</field><next><block type="comment"><field name="TEXT">**  Quick Start Examples  **</field><next><block type="comment"><field name="TEXT">**    -{1st Example}-     **</field><next><block type="comment"><field name="TEXT">****************************</field><next><block type="kos_clearscreen"><next><block type="text_print" inline="false"><value name="TEXT"><block type="text"><field name="TEXT">==HELLO WORLD==</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block>

        <block type="comment"><field name="TEXT">****************************</field><next><block type="comment"><field name="TEXT">**  Quick Start Examples  **</field><next><block type="comment"><field name="TEXT">**    -{2nd Example}-     **</field><next><block type="comment"><field name="TEXT">****************************</field><next><block type="variables_set" inline="true"><field name="VAR">countdown</field><value name="VALUE"><block type="math_number"><field name="NUM">10</field></block></value><next><block type="text_print" inline="false"><value name="TEXT"><block type="text"><field name="TEXT">Counting down:</field></block></value><next><block type="controls_whileUntil" inline="false"><field name="MODE">UNTIL</field><value name="BOOL"><block type="logic_compare" inline="true"><field name="OP">EQ</field><value name="A"><block type="variables_get"><field name="VAR">countdown</field></block></value><value name="B"><block type="math_number"><field name="NUM">0</field></block></value></block></value><statement name="DO"><block type="text_print" inline="false"><value name="TEXT"><block type="text_join" inline="false"><mutation items="2"></mutation><value name="ADD0"><block type="text"><field name="TEXT">...</field></block></value><value name="ADD1"><block type="variables_get"><field name="VAR">countdown</field></block></value></block></value><next><block type="variables_set" inline="true"><field name="VAR">countdown</field><value name="VALUE"><block type="math_arithmetic" inline="true"><field name="OP">MINUS</field><value name="A"><block type="variables_get"><field name="VAR">countdown</field></block></value><value name="B"><block type="math_number"><field name="NUM">1</field></block></value></block></value><next><block type="kos_wait" inline="false"><value name="TIME"><block type="math_number"><field name="NUM">1</field></block></value></block></next></block></next></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block>

  <block type="comment">
    <field name="TEXT">3rd Quick Start Example</field>
    <comment pinned="false">****************************
**  Quick Start Examples  **
**    -{3rd Example}-     **
****************************
    </comment>
    <next>
      <block type="variables_set" inline="true">
        <field name="VAR">countdown</field>
        <value name="VALUE">
          <block type="math_number">
            <field name="NUM">10</field>
          </block>
        </value>
        <next>
          <block type="text_print" inline="false">
            <value name="TEXT">
              <block type="text">
                <field name="TEXT">Counting down:</field>
              </block>
            </value>
            <next>
              <block type="controls_whileUntil" inline="false">
                <field name="MODE">UNTIL</field>
                <value name="BOOL">
                  <block type="logic_compare" inline="true">
                    <field name="OP">EQ</field>
                    <value name="A">
                      <block type="variables_get">
                        <field name="VAR">countdown</field>
                      </block>
                    </value>
                    <value name="B">
                      <block type="math_number">
                        <field name="NUM">0</field>
                      </block>
                    </value>
                  </block>
                </value>
                <statement name="DO">
                  <block type="text_print" inline="false">
                    <value name="TEXT">
                      <block type="text_join" inline="false">
                        <mutation items="2"></mutation>
                        <value name="ADD0">
                          <block type="text">
                            <field name="TEXT">...</field>
                          </block>
                        </value>
                        <value name="ADD1">
                          <block type="variables_get">
                            <field name="VAR">countdown</field>
                          </block>
                        </value>
                      </block>
                    </value>
                    <next>
                      <block type="variables_set" inline="true">
                        <field name="VAR">countdown</field>
                        <value name="VALUE">
                          <block type="math_arithmetic" inline="true">
                            <field name="OP">MINUS</field>
                            <value name="A">
                              <block type="variables_get">
                                <field name="VAR">countdown</field>
                              </block>
                            </value>
                            <value name="B">
                              <block type="math_number">
                                <field name="NUM">1</field>
                              </block>
                            </value>
                          </block>
                        </value>
                        <next>
                          <block type="kos_wait" inline="false">
                            <value name="TIME">
                              <block type="math_number">
                                <field name="NUM">1</field>
                              </block>
                            </value>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </statement>
                <next>
                  <block type="text_print" inline="false">
                    <value name="TEXT">
                      <block type="text">
                        <field name="TEXT">Main throttle up. 2 seconds to stabalize it.</field>
                      </block>
                    </value>
                    <next>
                      <block type="kos_lock" inline="true">
                        <value name="TARGET">
                          <block type="RawControl_properties" inline="false">
                            <mutation second_input="false"></mutation>
                            <field name="NAME">MAINTHROTTLE</field>
                          </block>
                        </value>
                        <value name="VALUE">
                          <block type="math_number">
                            <field name="NUM">1</field>
                          </block>
                        </value>
                        <next>
                          <block type="kos_wait" inline="false">
                            <value name="TIME">
                              <block type="math_number">
                                <field name="NUM">2</field>
                              </block>
                            </value>
                            <next>
                              <block type="controls_whileUntil" inline="false">
                                <field name="MODE">UNTIL</field>
                                <value name="BOOL">
                                  <block type="logic_compare" inline="true">
                                    <field name="OP">GT</field>
                                    <value name="A">
                                      <block type="Vessel_properties" inline="false">
                                        <mutation second_input="false"></mutation>
                                        <field name="NAME">MAXTHRUST</field>
                                        <value name="PARENT">
                                          <block type="kos_vessels_ship"></block>
                                        </value>
                                      </block>
                                    </value>
                                    <value name="B">
                                      <block type="math_number">
                                        <field name="NUM">0</field>
                                      </block>
                                    </value>
                                  </block>
                                </value>
                                <statement name="DO">
                                  <block type="kos_wait" inline="false">
                                    <value name="TIME">
                                      <block type="math_number">
                                        <field name="NUM">0.5</field>
                                      </block>
                                    </value>
                                    <next>
                                      <block type="text_print" inline="false">
                                        <value name="TEXT">
                                          <block type="text">
                                            <field name="TEXT">Stage activated.</field>
                                          </block>
                                        </value>
                                        <next>
                                          <block type="kos_stage"></block>
                                        </next>
                                      </block>
                                    </next>
                                  </block>
                                </statement>
                                <next>
                                  <block type="kos_wait_until" inline="false">
                                    <value name="CONDITION">
                                      <block type="logic_compare" inline="true">
                                        <field name="OP">GT</field>
                                        <value name="A">
                                          <block type="Vessel_properties" inline="false">
                                            <mutation second_input="false"></mutation>
                                            <field name="NAME">MAXTHRUST</field>
                                            <value name="PARENT">
                                              <block type="kos_vessels_ship"></block>
                                            </value>
                                          </block>
                                        </value>
                                        <value name="B">
                                          <block type="math_number">
                                            <field name="NUM">0</field>
                                          </block>
                                        </value>
                                      </block>
                                    </value>
                                    <next>
                                      <block type="comment">
                                        <field name="TEXT">Final Comments</field>
                                        <comment pinned="false" h="113" w="502">NOTE that it is vital to not just let the script end right away
here.  Once a kOS script just ends, it releases all the controls
back to manual piloting so that you can fly the ship by hand again.
If the pogram just ended here, then that would cause the throttle
to turn back off again right away and nothing would happen.
                                        </comment>
                                      </block>
                                    </next>
                                  </block>
                                </next>
                              </block>
                            </next>
                          </block>
                        </next>
                      </block>
                    </next>
                  </block>
                </next>
              </block>
            </next>
          </block>
        </next>
      </block>
    </next>
  </block>
      </category>
      <category name="Randomize">
        <block type="procedures_defnoreturn">
          <mutation>
            <arg name="list"></arg>
          </mutation>
          <field name="NAME">randomize</field>
          <statement name="STACK">
            <block type="controls_for" inline="true">
              <field name="VAR">x</field>
              <value name="FROM">
                <block type="math_number">
                  <field name="NUM">1</field>
                </block>
              </value>
              <value name="TO">
                <block type="lists_length" inline="false">
                  <value name="VALUE">
                    <block type="variables_get">
                      <field name="VAR">list</field>
                    </block>
                  </value>
                </block>
              </value>
              <value name="BY">
                <block type="math_number">
                  <field name="NUM">1</field>
                </block>
              </value>
              <statement name="DO">
                <block type="variables_set" inline="false">
                  <field name="VAR">y</field>
                  <value name="VALUE">
                    <block type="math_random_int" inline="true">
                      <value name="FROM">
                        <block type="math_number">
                          <field name="NUM">1</field>
                        </block>
                      </value>
                      <value name="TO">
                        <block type="lists_length" inline="false">
                          <value name="VALUE">
                            <block type="variables_get">
                              <field name="VAR">list</field>
                            </block>
                          </value>
                        </block>
                      </value>
                    </block>
                  </value>
                  <next>
                    <block type="variables_set" inline="false">
                      <field name="VAR">temp</field>
                      <value name="VALUE">
                        <block type="lists_getIndex" inline="true">
                          <mutation statement="false" at="true"></mutation>
                          <field name="MODE">GET</field>
                          <field name="WHERE">FROM_START</field>
                          <value name="AT">
                            <block type="variables_get">
                              <field name="VAR">y</field>
                            </block>
                          </value>
                          <value name="VALUE">
                            <block type="variables_get">
                              <field name="VAR">list</field>
                            </block>
                          </value>
                        </block>
                      </value>
                      <next>
                        <block type="lists_setIndex" inline="false">
                          <value name="AT">
                            <block type="variables_get">
                              <field name="VAR">y</field>
                            </block>
                          </value>
                          <value name="LIST">
                            <block type="variables_get">
                              <field name="VAR">list</field>
                            </block>
                          </value>
                          <value name="TO">
                            <block type="lists_getIndex" inline="true">
                              <mutation statement="false" at="true"></mutation>
                              <field name="MODE">GET</field>
                              <field name="WHERE">FROM_START</field>
                              <value name="AT">
                                <block type="variables_get">
                                  <field name="VAR">x</field>
                                </block>
                              </value>
                              <value name="VALUE">
                                <block type="variables_get">
                                  <field name="VAR">list</field>
                                </block>
                              </value>
                            </block>
                          </value>
                          <next>
                            <block type="lists_setIndex" inline="false">
                              <value name="AT">
                                <block type="variables_get">
                                  <field name="VAR">x</field>
                                </block>
                              </value>
                              <value name="LIST">
                                <block type="variables_get">
                                  <field name="VAR">list</field>
                                </block>
                              </value>
                              <value name="TO">
                                <block type="variables_get">
                                  <field name="VAR">temp</field>
                                </block>
                              </value>
                            </block>
                          </next>
                        </block>
                      </next>
                    </block>
                  </next>
                </block>
              </statement>
            </block>
          </statement>
        </block>
      </category>
      <category name="Jabberwocky">
        <block type="text_print">
          <value name="TEXT">
            <block type="text">
              <field name="TEXT">'Twas brillig, and the slithy toves</field>
            </block>
          </value>
          <next>
            <block type="text_print">
              <value name="TEXT">
                <block type="text">
                  <field name="TEXT">  Did gyre and gimble in the wabe:</field>
                </block>
              </value>
              <next>
                <block type="text_print">
                  <value name="TEXT">
                    <block type="text">
                      <field name="TEXT">All mimsy were the borogroves,</field>
                    </block>
                  </value>
                  <next>
                    <block type="text_print">
                      <value name="TEXT">
                        <block type="text">
                          <field name="TEXT">  And the mome raths outgrabe.</field>
                        </block>
                      </value>
                    </block>
                  </next>
                </block>
              </next>
            </block>
          </next>
        </block>
        <block type="text_print">
          <value name="TEXT">
            <block type="text">
              <field name="TEXT">"Beware the Jabberwock, my son!</field>
            </block>
          </value>
          <next>
            <block type="text_print">
              <value name="TEXT">
                <block type="text">
                  <field name="TEXT">  The jaws that bite, the claws that catch!</field>
                </block>
              </value>
              <next>
                <block type="text_print">
                  <value name="TEXT">
                    <block type="text">
                      <field name="TEXT">Beware the Jubjub bird, and shun</field>
                    </block>
                  </value>
                  <next>
                    <block type="text_print">
                      <value name="TEXT">
                        <block type="text">
                          <field name="TEXT">  The frumious Bandersnatch!"</field>
                        </block>
                      </value>
                    </block>
                  </next>
                </block>
              </next>
            </block>
          </next>
        </block>
      </category>
    </category>
    </xml>
      </td>
    </tr>
  </table>

  <div id="content_blocks" class="content"></div>
  <pre id="content_kerboscript" class="content"></pre>
  <textarea id="content_xml" class="content" wrap="off"></textarea>

  <!-- From apps.storageDialog.  -->
  <div id="dialogStorage" class="dialogHiddenContent">
    <div id="containerStorage"></div>
    <!-- apps.ok  -->
    <div class="farSide" style="padding: 1ex 3ex 0">
      <button class="secondary" onclick="BlocklyApps.hideDialog(true)">OK</button>
    </div>
  </div>

  <!-- This is opened if the user tries generating KerboScript but has a disallowed -->
  <!-- construct, such as a disconnected input/output.  -->
  <div id="badBlockDiv" class="dialogHiddenContent">
    <table>
      <tbody>
        <tr>
          <td id="badBlockMsg" colspan=2></td>
        </tr>
        <tr>
          <td colspan=2>The resulting program would probably not be correct.</td>
        </tr>
        <tr>
          <td>
            <button id='badBlockDoneButton' onclick="BlocklyApps.hideDialog();">
              OK
            </button>
          </td>
          <td>
            <button id='badBlockCodeButton' style='float:right'
                    onclick="BlocklyApps.hideDialog();Code.tabClick('tab_kerboscript!');">
              Generate KerboScript anyway
            </button>
          </td>
        </tr>
      </tbody>
    </table>

  </div>

  <!-- This is opened when the user clicks the Pastebin button. -->
  <div id="pastebinDiv" class="dialogHiddenContent">
    <form id="pastebinForm"
          action='http://pastebin.com/api/api_post.php'
          target='resultFrame' method='post'>
      <input type='hidden' name='api_dev_key' value="760d394bb62222e4b20e9dcfa0ab8934">
      <input type='hidden' name='api_option' value='paste'>
      <input type='hidden' name='api_paste_private' value='1'>
      <input type='hidden' name='api_paste_format', value='JavaScript'>
      <!-- Get api_dev_key. 
      <script type="text/javascript" src="key.js"></script> -->
      <input type='hidden' name='api_paste_code' id='kerboscriptCode'>

      <table>
        <tr>
          <td>
            Name: <input type='text' name='api_paste_name' value='KerboScript program'>
          </td><td>
            Expiration time:
            <select name='api_paste_expire_date'>
              <option value="1D">1 day</option>
              <option value="1W" selected>1 week</option>
              <option value="2W">2 weeks</option>
              <option value="1M">1 month</option>
            </select>
          </td>
        </tr>
        <tr>
          <td colspan=2>Warning: You can only do ten saves to Pastebin in a 24-hour period.</td>
        </tr>
        <tr>
          <td>
            <button id='pastebinSaveButton'
            onclick="this.setAttribute('class', 'hiddenButton');
                     document.getElementById('kerboscriptCode').value = Blockly.kOS.workspaceToCode();
                     var iframe = document.getElementById('resultFrame');
                     iframe.setAttribute('class', 'visibleIframe');
                     iframe.contentWindow.document.open();
                     iframe.contentWindow.document.write('Pasting...');
                     iframe.contentWindow.document.close();
                     document.getElementById('pastebinForm').submit(function( event ) {
                        alert( 'Event' );
                      });">Save program to Pastebin</button>
          </td>
          <td>
            <button id='doneButton'
                    onclick="var pb = document.getElementById('pastebinSaveButton');
                             pb.setAttribute('class', '');
                             BlocklyApps.hideDialog();">Return to program</button>
          </td>
        </tr>
        <tr>
          <td colspan=2>
            <iframe name='resultFrame' id='resultFrame' class="hiddenIframe"></iframe>
          </td>
        </tr>
      </table>
    </form>
  </div>
  </body>
</html>
